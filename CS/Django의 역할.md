[[ê°œë…\] DjangoëŠ” Web Serverê°€ ì•„ë‹ˆë¼êµ¬ìš”!!](https://jay-ji.tistory.com/66)

[ğŸ’» í”„ë¡œê·¸ë˜ë°/Django](https://jay-ji.tistory.com/category/ğŸ’» í”„ë¡œê·¸ë˜ë°/Django) 2020. 8. 10. 19:38



ì•ˆë…•í•˜ì„¸ìš”! **ìš´ë™í•˜ëŠ” ê°œë°œì Jay**ì…ë‹ˆë‹¤. ì˜¤ëŠ˜ì€ **Django, Nginx, WSGI,** **gunicorn**ì˜ ê°œë…ì ì¸ ë‚´ìš©ì„ ê°„ë‹¨íˆ ë‹¤ë¤„ë³´ë ¤ê³  í•©ë‹ˆë‹¤.
ì‚¬ì‹¤ ì›¹ ê°œë°œìë¡œì„œ ì²˜ìŒ ì»¤ë¦¬ì–´ë¥¼ ì‹œì‘í–ˆì„ë•Œ, ë§ì´ í—·ê°ˆë ¸ë˜ ë¶€ë¶„ì´ì—ˆìŠµë‹ˆë‹¤.

 

> **"ìš°ë¦¬ íšŒì‚¬ ì›¹ ì„œë²„ëŠ” Djangoë¥¼ ì‚¬ìš©í•´!"** 

 

ê°œë°œì ì¹œêµ¬ë“¤ì„ ë§Œë‚˜ë©´ ì´ë ‡ê²Œ ì„¤ëª… í–ˆë˜ ê²ƒ ê°™ìŠµë‹ˆë‹¤.ã…ã…ã… ê·¼ë° ì‚¬ì‹¤ **ì •í™•íˆ ë”°ì§€ìë©´, í‹€ë¦° ë§ì´ì£ !** (ì°½í”¼í•¨ğŸ˜±)

ì•„ë§ˆ, ì € ì²˜ëŸ¼ ì²˜ìŒ ì›¹ ê°œë°œìë¡œì„œ ì»¤ë¦¬ì–´ë¥¼ ì‹œì‘í•˜ì‹œëŠ” ë¶„ë“¤ë„ ì´ëŸ° ê°œë…ì— í—·ê°ˆë¦¬ì…¨ì„ ìˆ˜ë„ ìˆì„ ê²ƒ ê°™ì•„ìš”! (**ë‚˜ë§Œ ê·¸ëŸ° ê±´ê°€ hoxy?**)

 

## **1. Djangoì˜ ì—­í• ì´ ê·¸ë˜ì„œ ì •í™•íˆ ë­”ë°??**

------



![img](https://blog.kakaocdn.net/dn/kU3nw/btqGnINfMg2/5Kqk8CbWeXUknlbI5k4roK/img.png)



ë„¤! ê·¸ë˜ì„œ **Django**ì˜ ì—­í• ì€ ë„ëŒ€ì²´ ë­˜ê¹Œìš”? ì´ë¯¸ ë‹¤ë“¤ ì•Œê³  ê³„ì‹ í…ë° **Django**ëŠ” **Web Server**ê°€ ì•„ë‹ˆë¼ **Web Application Framework**ì…ë‹ˆë‹¤. 

 



![img](https://blog.kakaocdn.net/dn/bcnhKq/btqGrjez1Lc/vfEfFzOtKygk5lqSHa0Hm0/img.png)Django ì„¤ëª…



ë³´í†µ ì²˜ìŒ **Django** ë“€í† ë¦¬ì–¼ì„ ì‹œì‘í•˜ê²Œ ë˜ë©´, í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ê³  ì•„ë˜ ëª…ë ¹ì–´ë¡œ ì„œë²„ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

 

> ./manage.py runserver (= python manage.py runserver)

 

í•˜ì§€ë§Œ, ì´ê²ƒì€ **debug**ìš©ìœ¼ë¡œ **local**ì—ì„œë§Œ ì‚¬ìš©í•´ì•¼ í•˜ê³  ì‹¤ì œ **production** í™˜ê²½ì—ì„œëŠ” ì¶”ì²œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.(ì‚¬ìš© x)

 



![img](https://blog.kakaocdn.net/dn/PiUeS/btqGqQwUV0B/qjZCFwNVpWBM92ySs2Oga1/img.png)Django runserver ì„¤ëª…ì¤‘ ì¼ë¶€ë¶„



**Django** ê³µì‹ ë¬¸ì„œì—ì„œë„ **production settingì—ì„œ ì‚¬ìš©í•˜ì§€ ë§ë¼**ê³  ì£¼ì˜ë¥¼ ì£¼ê³  ìˆìŠµë‹ˆë‹¤. (ë³´ì•ˆ ë° í¼í¬ë¨¼ìŠ¤ ì´ìŠˆ ìˆì„ ìˆ˜ ìˆìŒ)

ê·¸ë¦¬ê³  ë‘ë²ˆì§¸ ì¤„ì— ë³´ë©´ **Django**ëŠ” **Web server**ê°€ ì•„ë‹ˆë¼ê³  ë§í•©ë‹ˆë‹¤.

 

ì •í™•íˆëŠ” Django ê°œë°œìê°€ ***"ìš°ë¦¬ëŠ” ì›¹ í”„ë ˆì„ì›Œí¬ë¥¼ ë§Œë“¤ì§€ ì›¹ ì„œë²„ë¥¼ ë§Œë“œëŠ” ê±´ ì•„ë‹Œë‹¤. ê·¸ë˜ì„œ ì‹¤ì„œë²„ í™˜ê²½ì—ì„œ ë‹¤ë£° ìˆ˜\* \*ìˆëŠ” ê±´ Djangoì˜ ì˜ì—­ ë°–ì´ë‹¤."\*** ë¼ê³  ë§í•˜ê³  ìˆë„¤ìš”. ã…ã… ê·¸ë˜ì„œ ìš”ì•½í•˜ìë©´,

> DjangoëŠ” Web Server ê°€ ì•„ë‹ˆë¼ Web Frameworkì´ë‹¤!

 

 

## **2. ê·¸ë˜ì„œ Web ServerëŠ” ë­ì•¼?**

------

ì, ì´ë²ˆ ê¸€ì˜ í•µì‹¬ì¤‘ í•˜ë‚˜ì£ ! **Web Server**!! ë‘êµ¬ë‘êµ¬ë‘êµ¬.....

(ëŒ€ë¬¸ì‘ ë§Œí•˜ê²Œ ì´ë¯¸ì§€ë¥¼ ë„£ì–´ë†“ê³  ë‘êµ¬ë‘êµ¬ í•˜ëŠ” ë‹¹ì‹ ì€...ëŒ€ì²´...ğŸ¤”)



![img](https://blog.kakaocdn.net/dn/bfMs3s/btqGqb2uok6/ZCLpZ6hFSl2imZazNJHedk/img.png)



> Web ServerëŠ” Nginx, Apache ê°™ì€ ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ë§í•©ë‹ˆë‹¤!

ì§œë€!! ì‚¬ì‹¤ ì €ëŠ” **Nginx**ë¥¼ ë‹¨ìˆœíˆ **proxy**(í”„ë¡ì‹œ) ê¸°ëŠ¥ì„ í•˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´(?) ì •ë„ë¡œë§Œ ìƒê°í–ˆìŠµë‹ˆë‹¤.

ì´ê²ƒë„ **Nginx**ì˜ ê¸°ëŠ¥ì´ê³  ë§ëŠ” ë§ì´ì§€ë§Œ, ì ì–´ë„ ì„¤ëª…ì„ í•  ë•Œ ***"Djangoë¥¼ Web Serverë¡œ ì‚¬ìš©í•˜ê³  ìˆì–´"***ë¼ëŠ” ë§ í•˜ëŠ” ê²Œ ì•„ë‹Œ ***"Web ServerëŠ” Nginxê³  Server Side FrameworkëŠ” Djangoë¥¼ ì‚¬ìš©í•˜ê³  ìˆì–´!"*** ë¼ê³  ë§í•´ì•¼ í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤.

 

#### ğŸ“Œ **Web Serverì˜ ì—­í• ** 

ì›¹ ì„œë²„ì˜ ì£¼ëœ ê¸°ëŠ¥ì€ ì›¹ í˜ì´ì§€ë¥¼ [í´ë¼ì´ì–¸íŠ¸](https://ko.wikipedia.org/wiki/í´ë¼ì´ì–¸íŠ¸)ë¡œ ì „ë‹¬í•˜ëŠ” ê²ƒì´ë‹¤. ì£¼ë¡œ [ê·¸ë¦¼](https://ko.wikipedia.org/wiki/ê·¸ë¦¼), [CSS](https://ko.wikipedia.org/wiki/CSS), [ìë°”ìŠ¤í¬ë¦½íŠ¸](https://ko.wikipedia.org/wiki/ìë°”ìŠ¤í¬ë¦½íŠ¸)ë¥¼ í¬í•¨í•œ [HTML](https://ko.wikipedia.org/wiki/HTML) ë¬¸ì„œê°€ [í´ë¼ì´ì–¸íŠ¸](https://ko.wikipedia.org/wiki/í´ë¼ì´ì–¸íŠ¸)ë¡œ ì „ë‹¬ëœë‹¤. (from [ìœ„í‚¤ë°±ê³¼](https://ko.wikipedia.org/wiki/ì›¹_ì„œë²„))

 

ìœ„í‚¤ì—ë„ ë‚˜ì™€ìˆë“¯ì´ ì›¹ì„œë²„ëŠ” **ì •ì (image, css, js)ì¸ ì •ë³´**ë¥¼ ë°˜í™˜í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. ëŒ€í‘œì ì¸ **Web Server**ë¡œëŠ” **Nginx, Apache, GWS** ë“±ì´ ìˆì£ !

 

ê°œì¸ì ìœ¼ë¡œ **Apache**ëŠ” ëŒ€í•™êµ 2í•™ë…„ ë•Œ (ì–´ì–¸ 7ë…„...) í† ì´ í”„ë¡œì íŠ¸ í•œë‹¤ê³  ì¨ë´¤ê³ , ì§€ê¸ˆ ë‹¤ë‹ˆëŠ” íšŒì‚¬ì—ì„œ ì›¹ ê°œë°œìë¡œ ì¼í•˜ë©´ì„œ **Nginx**ë¥¼ ì¨ë´¤ë„¤ìš”ã…ã… ìš”ì¦˜ì—ëŠ” **Nginx**ë¥¼ ë§ì´ ì“´ë‹¤ê³  í•©ë‹ˆë‹¤.

 

**Apache**ì™€ **Nginx**ì˜ ì°¨ì´ëŠ” ê°„ë‹¨í•˜ê²Œ **Apache**ëŠ” **request**ì— ëŒ€í•´ **process**(+thread) í•˜ë‚˜ì”© ì‚¬ìš©í•˜ê³  **Nginx**ëŠ” **Event-Driven** ë°©ì‹ìœ¼ë¡œ ë¹„ë™ê¸° ì²˜ë¦¬í•œë‹¤ê³  í•©ë‹ˆë‹¤. ë‘ Web Serverì˜ ì°¨ì´ëŠ” [ì—¬ê¸°ì„œ](https://taes-k.github.io/2019/03/08/server-nginx-event-driven/) í™•ì¸í•´ ì£¼ì„¸ìš”!

 

 

## **3. WSGIëŠ” ë˜ ë­ê³  gunicornì€ ë­ì•¼?**

------

**WSGI**ëŠ” **Web Server Gateway Interface**ì˜ ì•½ìì…ë‹ˆë‹¤. **WSGI**ëŠ” **python application**(python script)ì´ **Web Server**ì™€ í†µì‹ í•˜ê¸° ìœ„í•œ **í‘œì¤€ Interface**ì´ë©° **Python Framework**ì…ë‹ˆë‹¤! (ì¼ì¢…ì˜ í”„ë¡œí† ì½œì´ë¼ê³  ìƒê°í•˜ë©´ ì‰¬ìš¸ ê²ƒ ê°™ì•„ìš”)

 

#### ğŸ“Œ **WSGI ê°„ë‹¨ ì„¤ëª…** (from [ìœ„í‚¤ë°±ê³¼](https://ko.wikipedia.org/wiki/ì›¹_ì„œë²„_ê²Œì´íŠ¸ì›¨ì´_ì¸í„°í˜ì´ìŠ¤))

WSGIëŠ” [ì„œë²„](https://ko.wikipedia.org/wiki/ì„œë²„)ì™€ [ê²Œì´íŠ¸ì›¨ì´](https://ko.wikipedia.org/wiki/ê²Œì´íŠ¸ì›¨ì´) , [ì• í”Œë¦¬ì¼€ì´ì…˜](https://ko.wikipedia.org/wiki/ì• í”Œë¦¬ì¼€ì´ì…˜)ê³¼ [í”„ë ˆì„ì›Œí¬](https://ko.wikipedia.org/wiki/í”„ë ˆì„ì›Œí¬) ì–‘ë‹¨ìœ¼ë¡œ ë‚˜ëˆ ì ¸ ìˆë‹¤. WSGI ë¦¬í€˜ìŠ¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ë ¤ë©´, ì„œë²„ë‹¨ì—ì„œ í™˜ê²½ì •ë³´ì™€ ì½œë°± í•¨ìˆ˜ë¥¼ ì• í”Œë¦¬ì¼€ì´ì…˜ë‹¨ì— ì œê³µí•´ì•¼ í•œë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ê·¸ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê³  ë¯¸ë¦¬ ì œê³µëœ ì½œë°± í•¨ìˆ˜ë¥¼ í†µí•´ ì„œë²„ë‹¨ì— ì‘ë‹µí•œë‹¤. WSGI ë¯¸ë“¤ì›¨ì–´(ë¼ê³  ë¶ˆë¦°ë‹¤.)ê°€ WSGI ì„œë²„ì™€ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‚¬ì´ë¥¼ ë³´ì¶©í•´ì£¼ëŠ”ë°, ì´ ë¯¸ë“¤ì›¨ì–´ëŠ” ì„œë²„ì˜ ê´€ì ì—ì„œëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ, ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ê´€ì ì—ì„œëŠ” ì„œë²„ë¡œ í–‰ë™í•œë‹¤. ì´ ë¯¸ë“¤ì›¨ì–´ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê¸°ëŠ¥ì„ ê°€ì§„ë‹¤.

- í™˜ê²½ë³€ìˆ˜ê°€ ë°”ë€Œë©´ íƒ€ê²Ÿ URLì— ë”°ë¼ì„œ ë¦¬í€˜ìŠ¤íŠ¸ì˜ ê²½ë¡œë¥¼ ì§€ì •í•´ì¤€ë‹¤.
- ê°™ì€ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì—¬ëŸ¬ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ í”„ë ˆì„ì›Œí¬ê°€ ì‹¤í–‰ë˜ê²Œ í•œë‹¤.
- XSLT ìŠ¤íƒ€ì¼ì‹œíŠ¸ë¥¼ ì ìš©í•˜ëŠ” ê²ƒê³¼ ê°™ì´ ì „ì²˜ë¦¬ë¥¼ í•œë‹¤.

 

> **HTTP requests** -> **Web Server** -> **WSGI Server**(Middleware) -> **Django**(WSGIë¥¼ ì§€ì›í•˜ëŠ” Web Application)

 

ì´ëŸ° ì‹ìœ¼ë¡œ ë™ì‘ì´ ì´ë£¨ì–´ì§„ë‹¤ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ **WSGI Server**ë¼ê³  ìˆì£ ? ë°”ë¡œ ì´ê²ƒì´ **gunicorn**ì…ë‹ˆë‹¤.

(ì´ ì™¸ì—ë„ mod_wsgi, uwsgi ë“±ì´ ìˆìŒ)

 

#### **ğŸ“Œ gunicorn ê°„ë‹¨ ì„¤ëª…** 



![img](https://blog.kakaocdn.net/dn/kVZ3t/btqGte4ZoG8/vuozP4Nxe79z8nqZyDgpmk/img.png)gunicorn(green unicorn)



**gunicorn**ì€ **Python WSGI HTTP Server**ì…ë‹ˆë‹¤. **gunicorn**ì€ ìƒëŒ€ì ìœ¼ë¡œ ë¹ ë¥´ê³  ê°€ë³ê³  ì‚¬ìš©ì´ ì‰½ë‹¤ê³  í•©ë‹ˆë‹¤.

íŠ¹ì§•ì€ ì´ë ‡ìŠµë‹ˆë‹¤.

- [WSGI](https://en.wikipedia.org/wiki/Web_Server_Gateway_Interface), [web2py](https://en.wikipedia.org/wiki/Web2py), [Django](https://en.wikipedia.org/wiki/Django_(web_framework)) ê·¸ë¦¬ê³  [Paster](https://en.wikipedia.org/wiki/Python_Paste) ë¥¼ ì§€ì›
- Automatic worker [process management](https://en.wikipedia.org/wiki/Process_management_(computing))
- ê°„ë‹¨í•œ Python configuration
- Multiple worker configurations
- í™•ì¥ì„±(extensibility)ì„ ìœ„í•œ ë‹¤ì–‘í•œ Server hookë“¤
- python2.6+ ê·¸ë¦¬ê³  python3.2+ ê³¼ í˜¸í™˜ ê°€ëŠ¥

 

**Django**ì—ì„œëŠ” **wsgi.py**ì—ì„œ **application = get_wsgi_application()** ë¥¼ í†µí•´ **wsgi handler**ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. **wsgi handler**ì—ì„œëŠ” **middleware**ë“± ì„ ì²˜ë¦¬í•˜ê³ , **WSGI server**ì—ì„œëŠ” ì„¤ì •ì„ ì½ì–´ **application**ì˜ ê²½ë¡œë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

**Django** ê¸°ë³¸ ëª…ë ¹ì–´ì¸ [runserver](https://docs.djangoproject.com/en/3.0/ref/django-admin/#runserver) ëª…ë ¹ì€ [WSGI_APPLICATION](https://docs.djangoproject.com/en/3.0/ref/settings/#std:setting-WSGI_APPLICATION) ì„¤ì •ì—ì„œ ê²½ë¡œë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. 



 

## **4. ë§ˆì¹˜ë©°(ìš”ì•½)**

------



![img](https://blog.kakaocdn.net/dn/Q00Ay/btqGuqjD4JU/kvM3Jgdu77dBHqi6sqkfh1/img.png)Nginx, WSGI Server(gunicorn), Django ê´€ê³„



ê·¸ë˜ì„œ ìœ„ ë‚´ìš©ë“¤ì„ ê·¸ë¦¼ìœ¼ë¡œ ë³´ê¸° ì‰½ê²Œ ìš”ì•½í•˜ë©´, ìœ„ ì´ë¯¸ì§€ì²˜ëŸ¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤!! (ê·¸ë¦¼ìœ¼ë¡œ ë³´ë‹ˆê¹Œ í•œëˆˆì— ë³´ì´ì£ ?!)

ì´ëŸ° ìš©ì–´ë“¤ì´ë‚˜ ê´€ê³„ì— ëŒ€í•œ ê°œë…ì— ëŒ€í•´ì„œ ì•„ëŠ” ê²ƒì€ ***ë‹¤ë¥¸ ê°œë°œìë“¤ê³¼ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜í•  ë•Œ ì •ë§ ì¤‘ìš”***í•œ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ê°œë…ì´ ì •í™•íˆ ì¡í˜€ì•¼ ì²˜ìŒë¶€í„° í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ ë•Œ ì–´ëŠ ì •ë„ í”„ë¡œì íŠ¸ ì „ì²´ì ì¸ ì•„í‚¤í…ì²˜ë„ ë³´ì´ê³ ìš”!

 

ì €ë„ ì•„ì§ ì˜ ëª°ë¼ ì •ë¦¬í•´ë³´ë ¤ê³  ë§Œë“¤ì–´ì„œ ì„¤ëª…ì´ ë§ì´ ë¶€ì¡±í•˜ì§€ë§Œ, ë‹¤ë¥¸ ë¶„ë“¤ì—ê²Œ ì¡°ê¸ˆì´ë‚˜ë§ˆ ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ë„¤ìš”!

ê·¸ëŸ¼ ì˜¤ëŠ˜ í•˜ë£¨ë„ ì¦ê±°ìš´ í•˜ë£¨ ë³´ë‚´ì„¸ìš”!!

(ì˜ëª»ëœ ì„¤ëª…ì´ ë˜ì–´ìˆëŠ” ë¶€ë¶„ì´ ìˆë‹¤ë©´, ëŒ“ê¸€ë¡œ ì•Œë ¤ì£¼ì‹œë©´ ë§ì€ ë„ì›€ì´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤!!ğŸ™)